{% extends 'a_predict/_base.html' %}
{% load static %}
{% load i18n %}

{% block main %}
{{ info|json_script:'info' }}

{% if not student %}
    <article class="card tw-place-self-start"
             hx-target="#content" hx-swap="outerHTML swap:0.25s" hx-push-url="true">
        <div class="card-body text-center p-4">
            <div class="container my-4">
                <p>수험생 여러분, 그 동안 수고 많으셨습니다.</p>
                <p>여러분의 합격을 기원하는 마음과 함께</p>
                <p>아래와 같이 합격예측시스템을 제공해드리고 있습니다.</p>
                <p>모집단위와 직렬 및 응시번호, 이름을 입력하신 뒤,</p>
                <p>과목별 시험 답안을 제출해주시면 집계 후</p>
                <p>여러분의 합격 여부를 예측해드립니다.</p>
                {% if not user.is_authenticated %}
                    <a class="btn btn-outline-danger"
                       hx-target="body" hx-swap="innerHTML swap:0.25s"
                       hx-get="{% url 'account_login' %}?next={% url 'predict:index' %}">
                        로그인이 필요합니다.
                    </a>
                {% endif %}
            </div>
        </div>
    </article>
{% endif %}

{% if user.is_authenticated and student %}
    <section class="section htmx-fade-in htmx-fade-out" hx-target="#main" hx-swap="innerHTML swap:0.25s">
        <div class="row">
            <div class="col-12" aria-label="수험 정보">
                <div id="info_student" class="card htmx-fade-in htmx-fade-out">
                    {% include 'a_predict/snippets/index_info_student.html' %}
                </div>
            </div>
{#            student_id: {{ student.id }}<br/>#}
{#            exam_id: {{ exam.id }}<br/>#}
{#            현재 시각: {{ current_time }}<br/>#}
{#            시험 시작 시각: {{ exam.start_datetime }}<br/>#}
{#            시험 종료 시각: {{ exam.end_datetime }}<br/>#}
{#            예상 정답 공개시각: {{ exam.answer_predict_open_datetime }}<br/>#}
{#            정답 공개 시각: {{ exam.answer_open_datetime }}<br/>#}

            <div class="col-12" aria-label="답안 제출 현황">
                <div id="info_answer" class="card htmx-fade-in htmx-fade-out">
                    {% include 'a_predict/snippets/index_info_answer.html' %}
                </div>
            </div>
            {% if current_time > exam.answer_open_datetime %}
                <div class="col-12" aria-label="성적 예측 I [전체 데이터]">
                    <div id="sheet_score" class="card htmx-fade-in htmx-fade-out">
                        {% include 'a_predict/normal/snippets/index_sheet_score.html' %}
                    </div>
                </div>
                {% if filtered_score_student %}
                    <div class="col-12" aria-label="성적 예측 II [정답 공개 전 데이터]">
                        <div id="sheet_score" class="card htmx-fade-in htmx-fade-out">
                            {% include 'a_predict/normal/snippets/index_sheet_score_filtered.html' %}
                        </div>
                    </div>
                {% endif %}
            {% endif %}
            {% if current_time > exam.end_datetime and current_time < exam.answer_open_datetime %}
                <div class="col-12" aria-label="예상 정답">
                    <div id="info_student" class="card htmx-fade-in htmx-fade-out">
                        {% include 'a_predict/normal/snippets/index_sheet_answer_predict.html' %}
                    </div>
                </div>
            {% endif %}
            <div class="col-12" aria-label="정답 확인">
                <div id="sheet_answer" class="card htmx-fade-in htmx-fade-out">
                    {% include 'a_predict/normal/snippets/index_sheet_answer.html' %}
                </div>
            </div>
        </div>
    </section>
{% endif %}
{% endblock main %}
